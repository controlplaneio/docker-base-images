FROM busybox:latest AS source

RUN ls -lasp /bin

# ===

FROM gcr.io/distroless/base AS base

LABEL org.label-schema.license="MIT" \
    org.label-schema.vcs-url="https://github.com/controlplaneio/docker-base-images" \
    org.label-schema.vcs-type="Git" \
    org.label-schema.name="controlplaneio/build-env-base" \
    org.label-schema.vendor="controlplaneio" \
    org.label-schema.docker.schema-version="1.0"

COPY script /build-step/

# add busbox to distroless for debug and runtime
COPY --from=source /bin/busybox /bash
COPY --from=source /bin/busybox /bin/busybox
COPY --from=source /bin/busybox /bin/sh

RUN busybox --install && ls -lasp /bin/ && chmod +x /bash

RUN printf 'CuKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkQrilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpEK4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paRCuKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkQrilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpEK4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paI4paE4paR4paR4paR4paR4paR4paR4paR4paR4paR4paI4paE4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paRCuKWkeKWkeKWkeKWkeKWhOKWkeKWkeKWkeKWkeKWkeKWkeKWhOKWkeKWkeKWkeKWkeKWhOKWhOKWkeKWkeKWkeKWkeKWkeKWkeKWiOKWhCDilpHilpHilpHiloTilpHilpHiloTilpHilpHilpHilpHiloTilpHilpHilpHilpHilojilojilpHilpHilpHiloTiloTilpHilpHilpHilpHilojilojilpHilpHilpHiloTiloTiloTilpHilpHiloTiloTilpHilpHilpHilpHilpHilpHilpHilpHiloTilpHilpHilpHilpEK4paR4paR4paI4paI4paA4paI4paE4paR4paR4paI4paI4paA4paI4paE4paR4paR4paI4paI4paA4paI4paI4paE4paR4paI4paI4paI4paI4paE4paR4paR4paI4paI4paI4paA4paR4paR4paI4paI4paA4paI4paE4paR4paR4paI4paI4paR4paR4paI4paI4paI4paI4paE4paR4paR4paI4paI4paR4paR4paA4paA4paA4paI4paI4paR4paI4paI4paA4paI4paI4paE4paR4paE4paI4paI4paI4paI4paE4paR4paRCuKWkeKWiOKWiOKWkeKWkeKWkeKWkeKWkeKWiOKWiOKWkeKWkeKWkeKWiOKWiOKWkeKWiOKWiOKWkeKWkeKWiOKWiOKWkeKWkeKWiOKWiCDilpHilpHilpHilojilojilpHilpHilpHilojilojilpHilpHilpHilojilojilpHilojilojilpHilpHilojilojilpHilpHilojilojilpHilojilojilpHiloTilojilojilojilojilojilpHilojilojilpHilpHilojilojilpHilojilojiloTiloTiloTilojilpHilpEK4paR4paR4paI4paI4paR4paE4paI4paR4paR4paI4paI4paR4paI4paI4paR4paR4paI4paI4paR4paR4paI4paI4paR4paR4paI4paI4paR4paE4paR4paR4paI4paI4paR4paR4paR4paR4paI4paI4paR4paI4paI4paR4paR4paI4paI4paR4paR4paI4paI4paI4paI4paA4paR4paR4paI4paI4paR4paI4paI4paR4paR4paI4paI4paR4paI4paI4paR4paR4paI4paI4paR4paI4paI4paE4paR4paE4paE4paR4paRCuKWkeKWkeKWkeKWgOKWiOKWgOKWkeKWkeKWkeKWkeKWgOKWiOKWgOKWkeKWkeKWkeKWiOKWiOKWkeKWkeKWiOKWiOKWkeKWkeKWkeKWiOKWiOKWgOKWkeKWkeKWiOKWgOKWkeKWkeKWkeKWkeKWkeKWgOKWiOKWgOKWkeKWkeKWkeKWiOKWiOKWkeKWkeKWiOKWiOKWkeKWkeKWkeKWkeKWkeKWiOKWiOKWkeKWkeKWgOKWiOKWiOKWiOKWgOKWkeKWiOKWiOKWkeKWkeKWiOKWiOKWkeKWkeKWgOKWiOKWiOKWgOKWkeKWkeKWkQrilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilojilojilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpEK4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paRQGNvbnRyb2xwbGFuZWlv4paRCuKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkWluZm9AY29udHJvbC1wbGFuZS5pb+KWkQrilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpHilpFodHRwczovL2NvbnRyb2wtcGxhbmUuaW/ilpEK4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paRCgp8PiBCdWlsZCBzdGVwIHNjcmlwdCBkYXRhIGNvbnRhaW5lcgo=' | base64 -d && \
  echo && ls -lasp /build-step/ /bash && echo

RUN rm -rf /bin/
